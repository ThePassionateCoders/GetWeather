<SearchToolbar@MDBoxLayout>

	Widget:
		size_hint_x: .15


	MDTextField:
		id: search_textbar
		hint_text: "Enter your city"
		pos_hint: {"center_x": .5, "center_y": .5}
		size_hint_x: .7
		on_text_validate: app.searched(search_textbar.text)

	MDIconButton:
		id: search_button
		icon: "magnify"
		theme_text_color: "Custom"
		text_color: search_textbar.line_color_focus if search_textbar.focus else search_textbar.line_color_normal
		ripple_scale: 2
		pos_hint: {"center_x": .5, "center_y": .5}
		on_release: 
			app.searched(search_textbar.text)

	Widget:
		size_hint_x: .15

<ConfirmCity>
	check: check
	on_release: app.select_city(check, self)

	CheckboxLeftWidget:
		id: check
		group: "city"
		on_release: app.select_city(self, root)

<MyMDLabel@MDLabel>
	halign: "center"
	padding: (10, 10)

<MyImage@AsyncImage>
	canvas.before:
		Color:
			rgba: (209/255, 220/255, 222/255, 1)
  
		Rectangle:
			pos: self.pos
			size: self.size

MDScreen:
	id: app_screen

	MDToolbar:
		id: menubar 
		pos_hint: {"top": 1}
		title: "GET WEATHER"
		left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]] 

	SearchToolbar:
		id: search_toolbar
		y: app_screen.height - menubar.height - search_toolbar.height
		size_hint: (1, None)
		height: dp(75)

	MDNavigationLayout:

		ScreenManager:
			id: app_screen_manager

			MDScreen:
				id: main_screen
				name: "main screen"
				pos_hint: {"bottom": 0}
				size_hint_y: None
				height: root.height - search_toolbar.height - menubar.height

				ScrollView:

					size: main_screen.size
					do_scroll_x: False
					do_scroll_y: True

					MDGridLayout:
						cols: 1
						size_hint: (1, None)
						height: self.minimum_height
						spacing: 20
						padding: 20

						MDLabel:
							id: city_info
							size_hint: (1, None)
							adaptive_height: True
							markup: True
							text: f"{app.selected_city.text}, {app.selected_city.secondary_text}"
							font_size: dp(30)
							padding: (10, 0)

						MDCard:
							size_hint: (1, None)
							height: dp(120)
							elevation: 10
							radius: 20

							MDGridLayout:
								cols: 1

								MyMDLabel:
									id: current_weather_text
									text: app.selected_city.current['WeatherText']
									md_bg_color: app.theme_cls.primary_color
									size_hint: (1, None)
									height: dp(50)

								MDBoxLayout:

									AsyncImage:
										id: current_weather_icon
										source: f"https://developer.accuweather.com/sites/default/files/{app.selected_city.current['WeatherIcon']}-s.png"

									MyMDLabel:
										id: current_temp
										text: f"{app.selected_city.current['Temperature']} \u00B0C"
										font_size: dp(30) if app_screen.width > dp(250) else dp(25)

						MDCard:
							size_hint: (1, None)
							height: dp(500)
							elevation: 10
							radius: 20

							MDGridLayout:
								cols: 2 if app_screen.width > dp(270) else 1
								size: root.size

								MyMDLabel: 
									md_bg_color: app.theme_cls.primary_color
									text: "Current Conditions"
									halign: "left"

								MyMDLabel:
									id: current_datetime
									md_bg_color: app.theme_cls.primary_color
									text: app.selected_city.current['DateTime']
									halign: "right"

								MyMDLabel:
									text: "Real Feel Temperature"

								MyMDLabel:
									id: current_real_feel_temp
									text: f"{app.selected_city.current['RealFeelTemperature']} \u00B0C"
																		
								MyMDLabel:
									text: "Dew Point"
									md_bg_color: (209/255, 220/255, 222/255, 1)
									
								MyMDLabel:
									id: current_dew_point
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.current['DewPoint']} \u00B0C"
									
								MyMDLabel:
									text: "Cloud Cover"
									
								MyMDLabel:
									id: current_cloud_cover
									text: f"{app.selected_city.current['CloudCover']} %"
																		
								MyMDLabel:
									text: "Humidity"
									md_bg_color: (209/255, 220/255, 222/255, 1)
									
								MyMDLabel:
									id: current_relative_humidity
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.current['RelativeHumidity']} %"
									
								MyMDLabel:
									text: "Indoor Humidity"
									
								MyMDLabel:
									id: current_indoor_relative_humidity
									text: f"{app.selected_city.current['IndoorRelativeHumidity']} %"
									
								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Wind"
									
								MyMDLabel:
									id: current_wind
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.current['Wind']} km/hr"
									
								MyMDLabel:
									text: "Wind Gust"
									
								MyMDLabel:
									id: current_wind_gust
									text: f"{app.selected_city.current['WindGust']} km/hr"
									
								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "UV Index"
									
								MyMDLabel:
									id: current_uv_index
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: app.selected_city.current['UVIndex']
									
								MyMDLabel:
									text: "Visibility"
									
								MyMDLabel:
									id: current_visibility
									text: f"{app.selected_city.current['Visibility']} km"
									
								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Pressure"
									
								MyMDLabel:
									id: current_pressure
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.current['Pressure']} mb"
									
								MyMDLabel:
									text: "Precipitation"
									
								MyMDLabel:
									id: current_precipitation
									text: f"{app.selected_city.current['Precipitation']} mm"

						MDCard:
							size_hint: (1, None)
							height: dp(270)
							elevation: 10
							radius: 20

							MDGridLayout:
								cols: 2 if app_screen.width > dp(275) else 1
								size: root.size

								MyMDLabel: 
									md_bg_color: app.theme_cls.primary_color
									text: "Timmings"
									halign: "left"
									size_hint_y: None
									height: dp(50)	if app_screen.width > dp(275) else dp(25)

								MyMDLabel:
									id: current_date 
									md_bg_color: app.theme_cls.primary_color
									text: app.selected_city.current['DateTime'].split()[0]
									halign: "right"
									size_hint_y: None
									height: dp(50)	if app_screen.width > dp(275) else dp(25)			

								AsyncImage:
									source: "https://developer.accuweather.com/sites/default/files/01-s.png"

								MyMDLabel:
									id: sun
									text: f"Rise:{app.selected_city.current['SunRise']}\nSet:{app.selected_city.current['SunSet']}\n{app.selected_city.current['DateTime'].split()[1][-6:]}"

								AsyncImage:
									source: "https://developer.accuweather.com/sites/default/files/33-s.png"

								MyMDLabel:
									id: moon
									text: f"Rise:{app.selected_city.current['MoonRise']}\nSet:{app.selected_city.current['MoonSet']}\n{app.selected_city.current['DateTime'].split()[1][-6:]}"

						MDCard:
							size_hint: (1, None)
							height: dp(400)
							elevation: 10
							radius: 20

							MDGridLayout:
								cols: 1
								size: root.size

								MDGridLayout:
									cols: 2 if app_screen.width > dp(270) else 1
									size_hint_y: None 
									height: dp(50)

									MyMDLabel: 
										md_bg_color: app.theme_cls.primary_color
										text: "Forecast"
										halign: "left"

									MyMDLabel:
										id: forecast_date
										md_bg_color: app.theme_cls.primary_color
										text: app.selected_city.forecast['Date']
										halign: "right"

								MyMDLabel:		
									id: forecast_weather_text
									text: app.selected_city.forecast['WeatherText']
									md_bg_color: app.theme_cls.primary_light
									size_hint_y: None
									height: dp(50)

								MDGridLayout:
									cols: 2 if app_screen.width > dp(270) else 1
									size_hint_y: None 
									height: dp(300)

									MyMDLabel:
										text: "Minimum Temperature"

									MyMDLabel:
										id: forecast_min_temp
										text: f"{app.selected_city.forecast['MinTemp']} \u00B0C"
																			
									MyMDLabel:
										text: "Maximum Temperature"
										md_bg_color: (209/255, 220/255, 222/255, 1)
										
									MyMDLabel:
										id: forecast_max_temp
										md_bg_color: (209/255, 220/255, 222/255, 1)
										text: f"{app.selected_city.forecast['MaxTemp']} \u00B0C"
										
									MyMDLabel:
										text: "Minimum Real Feel"
										
									MyMDLabel:
										id: forecast_min_real_feel
										text: f"{app.selected_city.forecast['MinRealFeel']} \u00B0C"
										
									MyMDLabel:
										md_bg_color: (209/255, 220/255, 222/255, 1)
										text: "Maximum Real Feel"
										
									MyMDLabel:
										id: forecast_max_real_feel
										md_bg_color: (209/255, 220/255, 222/255, 1)
										text: f"{app.selected_city.forecast['MaxRealFeel']} \u00B0C"
																				
									MyMDLabel:
										text: "Hours of Sun"
										
									MyMDLabel:
										id: forecast_hrs_of_sun
										text: app.selected_city.forecast['HrsOfSun']

									MyMDLabel:
										md_bg_color: (209/255, 220/255, 222/255, 1)
										text: "Air Quality"
										
									MyMDLabel:
										id: forecast_air_quality
										md_bg_color: (209/255, 220/255, 222/255, 1)
										text: app.selected_city.forecast['AirQuality']

									MyMDLabel:
										text: "UV Index"
										
									MyMDLabel:
										id: forecast_uv_index
										text: app.selected_city.forecast['UVIndex']

						MDCard:
							size_hint: (1, None)
							height: dp(500)
							elevation: 10
							radius: 20

							MDGridLayout:
								cols: 2 if app_screen.width > dp(275) else 1
								size: root.size

								MyMDLabel: 
									md_bg_color: app.theme_cls.primary_color
									text: "Day Forecast"
									halign: "left"

								MyMDLabel:
									id: day_forecast_date
									md_bg_color: app.theme_cls.primary_color
									text: app.selected_city.forecast['Date']
									halign: "right"

								AsyncImage:
									id: day_forecast_icon
									source: f"https://developer.accuweather.com/sites/default/files/{app.selected_city.day_forecast['Icon']}-s.png"

								MyMDLabel:
									id: day_forecast_text
									text: app.selected_city.day_forecast['Text']

								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Precipitation Probability"

								MyMDLabel:
									id: day_forecast_precp_prob
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.day_forecast['PrecpProb']} %"
																		
								MyMDLabel:
									text: "Thunderstorm Probability"
									
								MyMDLabel:
									id: day_forecast_thunder_prob
									text: f"{app.selected_city.day_forecast['ThunderProb']} %"
									
								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Rain Probability"
									
								MyMDLabel:
									id: day_forecast_rain_prob
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.day_forecast['RainProb']} %"
									
								MyMDLabel:
									text: "Snow Probability"
									
								MyMDLabel:
									id: day_forecast_snow_prob
									text: f"{app.selected_city.day_forecast['SnowProb']} %"
									
								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Ice Probability"
									
								MyMDLabel:
									id: day_forecast_ice_prob
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.day_forecast['IceProb']} %"

								MyMDLabel:
									text: "Cloud Cover"
									
								MyMDLabel:
									id: day_forecast_cloud_cover
									text: f"{app.selected_city.day_forecast['CloudCover']} %"

								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Wind"
									
								MyMDLabel:
									id: day_forecast_wind
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.day_forecast['Wind']} km/hr"
									
								MyMDLabel:
									text: "Wind Gust"
									
								MyMDLabel:
									id: day_forecast_wind_gust
									text: f"{app.selected_city.day_forecast['WindGust']} km/hr"
								
						MDCard:
							size_hint: (1, None)
							height: dp(500)
							elevation: 10
							radius: 20

							MDGridLayout:
								cols: 2 if app_screen.width > dp(275) else 1
								size: root.size

								MyMDLabel: 
									md_bg_color: app.theme_cls.primary_color
									text: "Night Forecast"
									halign: "left"

								MyMDLabel:
									id: night_forecast_date
									md_bg_color: app.theme_cls.primary_color
									text: app.selected_city.forecast['Date']
									halign: "right"

								AsyncImage:
									id: night_forecast_icon
									source: "https://developer.accuweather.com/sites/default/files/{app.selected_city.night_forecast['Icon']}-s.png"

								MyMDLabel:
									id: night_forecast_text
									text: app.selected_city.night_forecast['Text']

								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Precipitation Probability"

								MyMDLabel:
									id: night_forecast_precp_prob
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.night_forecast['PrecpProb']} %"
																		
								MyMDLabel:
									text: "Thunderstorm Probability"
									
								MyMDLabel:
									id: night_forecast_thunder_prob
									text: f"{app.selected_city.night_forecast['ThunderProb']} %"
									
								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Rain Probability"
									
								MyMDLabel:
									id: night_forecast_rain_prob
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.night_forecast['RainProb']} %"
									
								MyMDLabel:
									text: "Snow Probability"
									
								MyMDLabel:
									id: night_forecast_snow_prob
									text: f"{app.selected_city.night_forecast['SnowProb']} %"
									
								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Ice Probability"
									
								MyMDLabel:
									id: night_forecast_ice_prob
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.night_forecast['IceProb']} %"

								MyMDLabel:
									text: "Cloud Cover"
									
								MyMDLabel:
									id: night_forecast_cloud_cover
									text: f"{app.selected_city.night_forecast['CloudCover']} %"

								MyMDLabel:
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: "Wind"
									
								MyMDLabel:
									id: night_forecast_wind
									md_bg_color: (209/255, 220/255, 222/255, 1)
									text: f"{app.selected_city.night_forecast['Wind']} km/hr"
									
								MyMDLabel:
									text: "Wind Gust"
									
								MyMDLabel:
									id: night_forecast_wind_gust
									text: f"{app.selected_city.night_forecast['WindGust']} km/hr"









		MDNavigationDrawer:
			id: nav_drawer

		